---
source_name: "Samples - tpch.lineitem"
source_query: "select * from tpch.lineitem"
rules:
- attribute_name: "max_receipt_date_by_nation"
  expression: "MAX([This].l_receiptdate) OVER (PARTITION BY [Samples - tpch.nation].n_nationkey)"
- attribute_name: "max_receipt_date_by_nation_plus_30"
  expression: "date_add([This].max_receipt_date_by_nation,30)"
- attribute_name: "net_price_int"
  expression: "[This].revenue*100"
- attribute_name: "net_price_no_returns"
  expression: "CASE WHEN [This].l_returnflag IS TRUE\n   THEN [This].net_price_int\n\
    \   ELSE 0\nEND"
- attribute_name: "partsupp_pkey"
  datatype: "string"
  expression: "CONCAT([This].l_partkey,'|',[This].l_suppkey)"
- attribute_name: "receipt_date_year_month"
  expression: "date_format([This].l_receiptdate, \"yyyyMM\")"
- attribute_name: "revenue"
  expression: "[This].l_extendedprice - [This].l_tax - [This].l_discount"
- attribute_name: "revenue_no_returns"
  expression: "CASE WHEN [This].l_returnflag IS TRUE\nTHEN [This].revenue\nELSE 0\n\
    END"
channels:
- output_name: "ML Inference - Nation Revenue Forecast"
  operation_type: "Aggregate"
  output_source_columns:
  - name: "Line_item_receipt_date"
    expression: "[This].max_receipt_date_by_nation_plus_30"
  - name: "nation_key"
    expression: "[Samples - tpch.nation].n_nationkey"
- output_name: "ML Training - LineItem by Nation and Receipt Date"
  output_source_name: "Auto-ML Demo - tpch.lineitem"
  filter: "[This].l_receiptdate BETWEEN '1993-01-01' AND '1998-12-31'"
  operation_type: "Aggregate"
  output_source_columns:
  - name: "line_item_net_price_100"
    expression: "[This].net_price_int"
    aggregate: "sum"
  - name: "Line_item_receipt_date"
    expression: "[This].l_receiptdate"
  - name: "nation_key"
    expression: "[Samples - tpch.nation].n_nationkey"
- output_name: "Reporting - TPCH OBT"
  output_source_name: "tpch.lineitem"
  output_source_columns:
  - name: "customer"
    expression: "[Samples - tpch.customer].c_name"
  - name: "customer_address"
    expression: "[Samples - tpch.customer].c_address"
  - name: "customer_comment"
    expression: "[Samples - tpch.customer].c_comment"
  - name: "customer_key"
    expression: "[Samples - tpch.customer].c_custkey"
  - name: "customer_market_segment"
    expression: "[Samples - tpch.customer].c_mktsegment"
  - name: "customer_nation"
    expression: "[Samples - tpch.nation].n_name"
  - name: "customer_nation_comment"
    expression: "[Samples - tpch.nation].n_comment"
  - name: "customer_nation_key"
    expression: "[Samples - tpch.nation].n_nationkey"
  - name: "customer_phone"
    expression: "[Samples - tpch.customer].c_phone"
  - name: "customer_region"
    expression: "[Samples - tpch.region].r_name"
  - name: "customer_region_comment"
    expression: "[Samples - tpch.region].r_comment"
  - name: "customer_region_key"
    expression: "[Samples - tpch.region].r_regionkey"
  - name: "order_comment"
    expression: "[Samples - tpch.orders].o_comment"
  - name: "order_date"
    expression: "[Samples - tpch.orders].o_orderdate"
  - name: "order_priority"
    expression: "[Samples - tpch.orders].o_orderpriority"
  - name: "order_ship_priority"
    expression: "[Samples - tpch.orders].o_shippriority"
  - name: "order_status"
    expression: "[Samples - tpch.orders].o_orderstatus"
  - name: "part"
    expression: "[Samples - tpch.part].p_name"
  - name: "part_brand"
    expression: "[Samples - tpch.part].p_brand"
  - name: "part_comment"
    expression: "[Samples - tpch.part].p_comment"
  - name: "part_container"
    expression: "[Samples - tpch.part].p_container"
  - name: "part_key"
    expression: "[This].l_partkey"
  - name: "part_manufacturer"
    expression: "[Samples - tpch.part].p_mfgr"
  - name: "part_supplier_comment"
    expression: "[Samples - tpch.partsupp].ps_comment"
  - name: "part_type"
    expression: "[Samples - tpch.part].p_type"
  - name: "supplier"
    expression: "[Samples - tpch.supplier].s_name"
  - name: "supplier_address"
    expression: "[Samples - tpch.supplier].s_address"
  - name: "supplier_comment"
    expression: "[Samples - tpch.supplier].s_comment"
  - name: "supplier_key"
    expression: "[Samples - tpch.supplier].s_suppkey"
  - name: "supplier_nation"
    expression: "[Samples - tpch.nation].n_name"
  - name: "supplier_nation_comment"
    expression: "[Samples - tpch.nation].n_comment"
  - name: "supplier_nation_key"
    expression: "[Samples - tpch.nation].n_nationkey"
  - name: "supplier_phone"
    expression: "[Samples - tpch.supplier].s_phone"
  - name: "supplier_region"
    expression: "[Samples - tpch.region].r_name"
  - name: "supplier_region_comment"
    expression: "[Samples - tpch.region].r_comment"
  - name: "supplier_region_key"
    expression: "[Samples - tpch.nation].n_regionkey"